# Werewolf LLM Engine — LLM 駆動人狼ゲーム基盤

---

## 概要

本プロジェクトは、**人狼ゲームの進行を LLM（大規模言語モデル）によって自動実行することを目的とした、Python 製のヘッドレスゲームエンジン**です。
UI・UX や通信機構を持たず、**上位レイヤー（CLI / Web / Bot / 実験基盤など）から呼び出されるライブラリ**としての利用を前提としています。

本ライブラリは、フェーズ管理、役職能力解決、投票・処刑、勝利判定といった人狼ゲームの中核ロジックを提供し、
各プレイヤーの発言・意思決定は LLM エージェントとして抽象化されます。

設定やルール、プロンプトは外部から注入可能であり、
研究用途・検証用途・エージェント比較・ゲームデザイン検証まで幅広く適用できる **汎用的な人狼実行基盤**を目指します。

---

## 設計方針

* UI・入出力方式を固定せず、組み込み用途に最適化する
* 役職・ルール・LLM を疎結合に保ち、拡張容易性を担保する
* 上位レイヤーからの制御を前提に、境界（インターフェース）を明確に設計する
* 再現性（乱数シード・決定論的進行）を重視し、検証と改善を加速させる

---

## 主な機能

人狼ゲームの進行制御を中核に、LLM エージェントによる会話・投票・能力行使を統合的に扱う機能を提供します。

* **ゲーム進行エンジン**
  夜・昼・投票・処刑・勝利判定といったフェーズ遷移を管理し、ゲーム状態を一貫して更新します。

* **役職・能力システム**
  人狼、村人、占い師などの役職を拡張可能な形で定義し、能力の解決順序や競合処理を制御できます。

* **LLM エージェントによる意思決定**
  各プレイヤーの発言、投票、能力行使を LLM またはルールベースエージェントで決定します。

* **設定注入型設計**
  役職構成、勝利条件、会話制約、プロンプト、乱数シードなどを外部から指定できます。

* **構造化イベント出力**
  発言、投票、能力結果、死亡、勝利といった出来事を、上位レイヤーで扱いやすいイベント形式で出力します。

* **再現可能なゲーム実行**
  同一設定・同一シードで同一進行を再現でき、実験や検証に適した設計です。

---

## 対象範囲

本プロジェクトは、人狼ゲームエンジンとしての**中核ロジック**に責務を集中させています。
そのため、以下の領域は提供範囲に含めていません。

* **ユーザーインターフェース層**
  チャット UI、Web 画面、音声入出力などは対象外とし、上位レイヤーでの実装を前提とします。

* **永続化・データ管理**
  ゲームログ、会話履歴、結果保存の方式は規定せず、利用側で設計可能とします。

* **LLM 認証情報の管理**
  API Key やモデル管理は外部で行う前提とします。

* **マッチング・ルーム管理**
  複数ゲーム管理や参加者管理はスコープ外とします。

---

## 他ライブラリとの差別化ポイント

本ライブラリは、**LLM 駆動の人狼ゲームコア**に特化して設計されています。

* **人狼ゲームのコアロジックに特化**
  UI や運用を切り離し、ゲーム進行そのものに集中しています。

* **LLM ファーストな設計**
  発言・推論・投票を LLM エージェントとして自然に組み込めます。

* **再現性と検証性**
  実験・比較・研究用途を前提とした決定論的設計により、改善サイクルを回しやすくしています。

* **拡張しやすい役職・ルール設計**
  新役職や特殊ルールを追加しやすい構造を採用し、応用の幅を広げます。

* **組み込み前提の API 設計**
  Bot、Web、分析基盤などからの呼び出しを想定し、インターフェースを明確に保ちます。

---

## 想定ユースケース

* **LLM エージェント研究・評価**
  複数モデルやプロンプトの推論・対話特性を比較する用途。

* **Bot・ゲームサービスへの組み込み**
  Discord や Slack 等の Bot の内部エンジンとしての利用。

* **ゲームデザイン検証**
  役職バランスやルール変更の影響を大量試行で検証。

* **会話・推論ログの分析基盤**
  LLM の振る舞いを構造化ログとして収集・分析。

---

## 対応要素（初期想定）

* フェーズ管理（夜／昼／投票／処刑）
* 基本役職（村人・人狼・占い師 など）
* LLM エージェント / ルールベースエージェント
* 勝利条件判定
* 構造化イベント出力

---

## アーキテクチャ概要

* ゲーム進行エンジン層
* 役職・能力定義層
* LLM エージェント抽象層
* ランタイム／オーケストレーション層

---

## インストール（予定）

```bash
pip install werewolf-llm
```

---

## クイックスタート（イメージ）

```python
from werewolf_llm import GameEngine, GameConfig

config = GameConfig(
    players=5,
    roles={"villager": 2, "werewolf": 2, "seer": 1},
    seed=42,
)

engine = GameEngine(config)
events = engine.run()

for event in events:
    print(event)
```

※ 上位レイヤーでイベントを解釈・表示・保存することを想定しています。

---

## 今後の予定

* 役職・ルール拡張用 API の整理（プラグイン的な追加を容易にする）
* 推論ログ／視点別ログ（プレイヤー視点・観戦視点）の拡張
* 人間参加を想定した入力注入インターフェース（Human-in-the-loop）
* ゲームの大量実行・評価を支援する実験ランナーの提供（ベンチマーク用途）
* **API 化（FastAPI 等）を想定したインターフェース整備**
  ライブラリの設計思想を維持しつつ、上位サービスとして API 提供できる形へ段階的に拡張します。
* PyPI 公開とドキュメント整備（設計指針・拡張ガイド・サンプルの充実）

---

## ライセンス

MIT License
